<UserControl x:Class="Machine_Performance_Management.Admin.AdminView"
              x:Name="AdminViewControl"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:viewmodel="clr-namespace:Machine_Performance_Management.Admin"
             d:DataContext="{d:DesignInstance Type=viewmodel:AdminViewModel}"
             mc:Ignorable="d"
             Background="#1F1C2C"
             d:DesignHeight="450" d:DesignWidth="800">
    <UserControl.Resources>
        <SolidColorBrush x:Key="PrimaryColor" Color="#2563EB"/>
        <SolidColorBrush x:Key="SecondaryColor" Color="#3B82F6"/>
        <SolidColorBrush x:Key="AccentColor" Color="#60A5FA"/>
        <SolidColorBrush x:Key="SuccessColor" Color="#10B981"/>
        <SolidColorBrush x:Key="WarningColor" Color="#F59E0B"/>
        <SolidColorBrush x:Key="DangerColor" Color="#EF4444"/>
        <SolidColorBrush x:Key="BackgroundLight" Color="#FFFFFF"/>
        <SolidColorBrush x:Key="BackgroundDark" Color="#F9FAFB"/>
        <SolidColorBrush x:Key="BorderColor" Color="#E5E7EB"/>
        <SolidColorBrush x:Key="TextPrimary" Color="#111827"/>
        <SolidColorBrush x:Key="TextSecondary" Color="#6B7280"/>

        <!-- Button Style -->
        <Style x:Key="ModernButtonStyle" TargetType="Button">
            <Setter Property="FontFamily" Value="Segoe UI"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="FontWeight" Value="Medium"/>
            <Setter Property="Height" Value="36"/>
            <Setter Property="MinWidth" Value="100"/>
            <Setter Property="Padding" Value="16,0"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border" 
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="6">
                            <ContentPresenter HorizontalAlignment="Center" 
                                            VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Opacity" Value="0.9"/>
                                <Setter Property="Effect">
                                    <Setter.Value>
                                        <DropShadowEffect Color="Black" Direction="320" 
                                                        ShadowDepth="2" Opacity="0.2" BlurRadius="5"/>
                                    </Setter.Value>
                                </Setter>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="border" Property="Opacity" Value="0.8"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="ComboboxStyle" TargetType="ComboBox">
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="BorderBrush" Value="Gray"/>
            <Setter Property="Padding" Value="2"/>
            <Setter Property="Background" Value="White"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
            <Setter Property="HorizontalAlignment" Value="Left"/>
            <Setter Property="MinWidth" Value="35"/>
            <Setter Property="FontSize" Value="27"/>
            <Setter Property="FontFamily" Value="Segoe UI"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ComboBox">
                        <Grid>
                            <!-- Viền ngoài của ComboBox -->
                            <Border Background="{TemplateBinding Background}"
                              BorderBrush="{TemplateBinding BorderBrush}"
                              BorderThickness="{TemplateBinding BorderThickness}"
                              CornerRadius="10"
                              Padding="2">
                                <Grid>
                                    <!-- Hiển thị giá trị đã chọn -->
                                    <ContentPresenter Name="ContentSite"
                                        IsHitTestVisible="False"
                                        Content="{TemplateBinding SelectionBoxItem}"
                                        ContentTemplate="{TemplateBinding SelectionBoxItemTemplate}"
                                        ContentStringFormat="{TemplateBinding SelectionBoxItemStringFormat}"
                                        VerticalAlignment="Center"
                                        HorizontalAlignment="Left"
                                        Margin="3"/>

                                    <!-- Nút mở dropdown -->
                                    <ToggleButton x:Name="DropDownToggle"
                                    Grid.Column="1"
                                    Background="Transparent"
                                    BorderThickness="0"
                                    HorizontalAlignment="Right"
                                    VerticalAlignment="Center"
                                    ClickMode="Press"
                                    IsChecked="{Binding IsDropDownOpen, RelativeSource={RelativeSource TemplatedParent}, Mode=TwoWay}"
                                    Width="25" Height="25" >
                                        <Path Fill="Black" Data="M 0 0 L 8 8 L 16 0 Z"
                                Width="20" Height="10"/>
                                    </ToggleButton>
                                </Grid>
                            </Border>

                            <!-- Popup chứa danh sách -->
                            <Popup x:Name="Popup"
                             Placement="Bottom"
                             IsOpen="{TemplateBinding IsDropDownOpen}"
                             AllowsTransparency="True"
                             Focusable="False">
                                <Border Background="White"
                                  BorderBrush="Gray"
                                  BorderThickness="1"
                                  CornerRadius="5"
                                  MinWidth="{TemplateBinding ActualWidth}">
                                    <ScrollViewer MaxHeight="275">
                                        <StackPanel IsItemsHost="True"/>
                                    </ScrollViewer>
                                </Border>
                            </Popup>
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Create Button Style -->
        <Style x:Key="CreateButtonStyle" TargetType="Button" BasedOn="{StaticResource ModernButtonStyle}">
            <Setter Property="Background" Value="{StaticResource SuccessColor}"/>
            <Setter Property="Foreground" Value="White"/>
        </Style>

        <!-- Update Button Style -->
        <Style x:Key="UpdateButtonStyle" TargetType="Button" BasedOn="{StaticResource ModernButtonStyle}">
            <Setter Property="Background" Value="{StaticResource SecondaryColor}"/>
            <Setter Property="Foreground" Value="White"/>
        </Style>

        <!-- Delete Button Style -->
        <Style x:Key="DeleteButtonStyle" TargetType="Button" BasedOn="{StaticResource ModernButtonStyle}">
            <Setter Property="Background" Value="{StaticResource DangerColor}"/>
            <Setter Property="Foreground" Value="White"/>
        </Style>


    </UserControl.Resources>
    <Grid>
        <TabControl SelectedIndex="{Binding SelectedTabIndex}">
            <TabItem Header="User Management"  FontSize="16" Foreground="#FF2E417E" FontWeight="Bold" >
                <Grid  Margin="1,1,1,1" Background="#1F1C2C">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="65*"/>
                        <RowDefinition Height="35"/>
                    </Grid.RowDefinitions>
                    <Grid Grid.Row="0" Background="#1F1C2C">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="65*"/>
                            <ColumnDefinition Width="35*"/>
                        </Grid.ColumnDefinitions>
                        <GroupBox Grid.Column="0" Margin="4,4,4,4" BorderThickness="0.5" BorderBrush="#404040" Foreground="White"  Header="Information">
                            <Grid >
                                <DataGrid  x:Name="UserDataGrid" 
                                               ItemsSource="{Binding UserData}"
                                               SelectedItem="{Binding SelectedUser, Mode=TwoWay}"
                                               AutoGenerateColumns="False"
                                               SelectionMode="Single" 
                                               SelectionUnit="FullRow" 
                                               IsReadOnly="True" 
                                               VerticalContentAlignment="Bottom"
                                               VerticalScrollBarVisibility="Auto"
                                               Background="Transparent"
                                               CanUserAddRows="False"
                                               ScrollViewer.HorizontalScrollBarVisibility="Auto"
                                               ScrollViewer.VerticalScrollBarVisibility="Auto"
                                               GridLinesVisibility="None"
                                               HeadersVisibility="Column"
                                               RowBackground="#1e1e2f"
                                               BorderThickness="0"
                                               AlternatingRowBackground="#21213a"
                                               >
                                    <DataGrid.Resources>
                                        <!-- Style cho DataGridCell - ĐÂY LÀ QUAN TRỌNG -->
                                        <Style TargetType="DataGridCell">
                                            <Setter Property="Background" Value="Transparent"/>
                                            <Setter Property="Foreground" Value="White"/>
                                            <Setter Property="BorderThickness" Value="0"/>
                                            <Setter Property="FontSize" Value="12"/>
                                            <Setter Property="Padding" Value="5"/>
                                            <!-- QUAN TRỌNG: Căn giữa nội dung -->
                                            <Setter Property="HorizontalContentAlignment" Value="Center"/>
                                            <Setter Property="VerticalContentAlignment" Value="Center"/>
                                            <!-- Template để căn giữa hoàn hảo -->
                                            <Setter Property="Template">
                                                <Setter.Value>
                                                    <ControlTemplate TargetType="DataGridCell">
                                                        <Border Background="{TemplateBinding Background}" 
                                BorderBrush="{TemplateBinding BorderBrush}" 
                                BorderThickness="{TemplateBinding BorderThickness}"
                                Padding="{TemplateBinding Padding}">
                                                            <ContentPresenter HorizontalAlignment="Center" 
                                            VerticalAlignment="Center"/>
                                                        </Border>
                                                    </ControlTemplate>
                                                </Setter.Value>
                                            </Setter>

                                            <!-- Triggers cho Cell -->
                                            <Style.Triggers>
                                                <!-- Khi row được selected -->
                                                <DataTrigger Binding="{Binding IsSelected, RelativeSource={RelativeSource AncestorType=DataGridRow}}" Value="True">
                                                    <Setter Property="Background" Value="#404040"/>
                                                    <Setter Property="Foreground" Value="White"/>
                                                </DataTrigger>
                                                <!-- Khi hover -->
                                                <DataTrigger Binding="{Binding IsMouseOver, RelativeSource={RelativeSource AncestorType=DataGridRow}}" Value="True">
                                                    <Setter Property="Background" Value="#404040"/>
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>

                                  
                                    </DataGrid.Resources>

                                    <!-- Style cho header -->
                                    <DataGrid.ColumnHeaderStyle>
                                        <Style TargetType="DataGridColumnHeader">
                                            <Setter Property="Background" Value="#25253a"/>
                                            <Setter Property="Foreground" Value="#949ba8"/>
                                            <Setter Property="FontWeight" Value="SemiBold"/>
                                            <Setter Property="FontSize" Value="15"/>
                                            <Setter Property="HorizontalContentAlignment" Value="Center"/>
                                            <Setter Property="VerticalContentAlignment" Value="Center"/>
                                            <Setter Property="Padding" Value="8,8"/>
                                            <Setter Property="Height" Value="40"/>
                                            <Setter Property="BorderThickness" Value="1,1,1,1"/>
                                            <Setter Property="BorderBrush" Value="Transparent"/>
                                        </Style>
                                    </DataGrid.ColumnHeaderStyle>



                                    <DataGrid.Columns >
                                        <DataGridTextColumn Header="No" Binding="{Binding No}" Width="auto" />
                                        <DataGridTextColumn Header="User Name" Binding="{Binding UserName}" Width="*" />
                                        <DataGridTextColumn Header="Password" Binding="{Binding PassWord}" Width="*" />
                                        <DataGridTextColumn Header="Role" Binding="{Binding Role}" Width="*" />
                                        <DataGridTextColumn Header="Full name" Binding="{Binding FullName}" Width="*" />
                                    </DataGrid.Columns>
                                </DataGrid>

                            </Grid>
                        </GroupBox>

                        <GroupBox Grid.Column="1"  Header="Editor" Foreground="White" BorderThickness="0.5" BorderBrush="#404040" Margin="4,4,4,4">
                            <Grid>
                                <DataGrid  x:Name="UserItemDataGrid" ItemsSource="{Binding SelectedItemDetails}" 
                                           SelectionMode="Single" 
                                           CanUserAddRows="False" 
                                           SelectionUnit="FullRow"  
                                           VerticalScrollBarVisibility="Auto"
                                          
                                           FontSize="15"
                                           Margin="5"
                                           Background="Transparent"
                                           AutoGenerateColumns="False"
                                           ScrollViewer.HorizontalScrollBarVisibility="Auto"
                                           ScrollViewer.VerticalScrollBarVisibility="Auto"
                                        
                                           GridLinesVisibility="None"
                                           HeadersVisibility="Column"
                                           RowBackground="#1e1e2f"
                                           BorderThickness="0"
                                           AlternatingRowBackground="#21213a"
                                           >

                                    <DataGrid.Resources>
                                        <!-- Style cho DataGridCell  -->
                                        <Style TargetType="DataGridCell">
                                            <Setter Property="Background" Value="Transparent"/>
                                            <Setter Property="Foreground" Value="White"/>
                                            <Setter Property="BorderThickness" Value="0"/>
                                            <Setter Property="FontSize" Value="12"/>
                                            <Setter Property="Padding" Value="5"/>

                                            <!-- Template để căn giữa hoàn hảo -->
                                            <Setter Property="Template">
                                                <Setter.Value>
                                                    <ControlTemplate TargetType="DataGridCell">
                                                        <Border Background="{TemplateBinding Background}" 
                                                             BorderBrush="{TemplateBinding BorderBrush}" 
                                                             BorderThickness="{TemplateBinding BorderThickness}"
                                                             Padding="{TemplateBinding Padding}">
                                                         <ContentPresenter HorizontalAlignment="Center" 
                                                         VerticalAlignment="Center"/>
                                                        </Border>
                                                    </ControlTemplate>
                                                </Setter.Value>
                                            </Setter>

                                            <!-- Triggers cho Cell -->
                                            <Style.Triggers>
                                                <!-- Khi row được selected -->
                                                <DataTrigger Binding="{Binding IsSelected, RelativeSource={RelativeSource AncestorType=DataGridRow}}" Value="True">
                                                    <Setter Property="Background" Value="#404040"/>
                                                    <Setter Property="Foreground" Value="White"/>
                                                </DataTrigger>
                                                <!-- Khi hover -->
                                                <DataTrigger Binding="{Binding IsMouseOver, RelativeSource={RelativeSource AncestorType=DataGridRow}}" Value="True">
                                                    <Setter Property="Background" Value="#404040"/>
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>


                                    </DataGrid.Resources>

                                    <!-- Style cho header -->
                                    <DataGrid.ColumnHeaderStyle>
                                        <Style TargetType="DataGridColumnHeader">
                                            <Setter Property="Background" Value="#25253a"/>
                                            <Setter Property="Foreground" Value="#949ba8"/>
                                            <Setter Property="FontWeight" Value="SemiBold"/>
                                            <Setter Property="FontSize" Value="15"/>
                                            <Setter Property="HorizontalContentAlignment" Value="Center"/>
                                            <Setter Property="VerticalContentAlignment" Value="Center"/>
                                            <Setter Property="Padding" Value="8,8"/>
                                            <Setter Property="Height" Value="40"/>
                                            <Setter Property="BorderThickness" Value="1,1,1,1"/>
                                            <Setter Property="BorderBrush" Value="Transparent"/>
                                        </Style>
                                    </DataGrid.ColumnHeaderStyle>

                                    <DataGrid.Columns>

                                        <!-- Cột User Management Edit -->
                                        <DataGridTextColumn Header="User Management Edit" Binding="{Binding UserEdit}" IsReadOnly="True" Width="110*"/>

                                        <!-- Cột Value -->
                                        <DataGridTemplateColumn Header="Value" Width="60*">
                                            <DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate>
                                                    <TextBlock Text="{Binding Value}"/>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellTemplate>

                                            <DataGridTemplateColumn.CellEditingTemplate>
                                                <DataTemplate>
                                                    <ContentControl Content="{Binding}">
                                                        <ContentControl.Style>
                                                            <Style TargetType="ContentControl">
                                                                <Setter Property="ContentTemplate">
                                                                    <Setter.Value>
                                                                        <DataTemplate>
                                                                            <TextBox Text="{Binding Value, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                                                                        </DataTemplate>
                                                                    </Setter.Value>
                                                                </Setter>
                                                                <Style.Triggers>
                                                                    <!-- Nếu NameSpec là "Role" thì hiển thị ComboBox thay vì TextBox -->
                                                                    <DataTrigger Binding="{Binding UserEdit}" Value="Role">
                                                                        <Setter Property="ContentTemplate">
                                                                            <Setter.Value>
                                                                                <DataTemplate>
                                                                                    <ComboBox ItemsSource="{Binding DataContext.Roles, RelativeSource={RelativeSource AncestorType=UserControl}}"
                                                                                    SelectedItem="{Binding Value, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>

                                                                                </DataTemplate>
                                                                            </Setter.Value>
                                                                        </Setter>
                                                                    </DataTrigger>
                                                                    <DataTrigger Binding="{Binding UserEdit}" Value="SomeOtherValue">
                                                                        <Setter Property="ContentTemplate">
                                                                            <Setter.Value>
                                                                                <DataTemplate>
                                                                                    <TextBox Text="{Binding Value, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                                                                                </DataTemplate>
                                                                            </Setter.Value>
                                                                        </Setter>
                                                                    </DataTrigger>
                                                                    <!-- Bạn có thể thêm các DataTrigger khác nếu cần thiết -->
                                                                </Style.Triggers>
                                                            </Style>
                                                        </ContentControl.Style>
                                                    </ContentControl>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellEditingTemplate>
                                        </DataGridTemplateColumn>
                                        
                                    </DataGrid.Columns>

                                </DataGrid>
                            </Grid>
                        </GroupBox>
                    </Grid>
                    <StackPanel Grid.Row="1" 
                              Orientation="Horizontal" 
                              HorizontalAlignment="Right"
                              Margin="0,0,15,0">
                        <Button Command="{Binding AddCommand}" 
                              Content="Create" 
                              Style="{StaticResource CreateButtonStyle}"
                              Margin="0,0,8,0"/>
                        <Button Command="{Binding EditCommand}" 
                              Content="Update" 
                              Style="{StaticResource UpdateButtonStyle}"
                              Margin="0,0,8,0"/>
                        <Button Command="{Binding DeleteCommand}" 
                              Content="Delete" 
                              Style="{StaticResource DeleteButtonStyle}"/>
                    </StackPanel>
                </Grid>
            </TabItem>
            
            
            <TabItem Header="Factory" FontSize="16" Foreground="#FF2E417E" FontWeight="Bold" >
                <Grid  Margin="1,1,1,1" Background="#1F1C2C">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="65*"/>
                        <RowDefinition Height="35"/>
                    </Grid.RowDefinitions>
                    <Grid Grid.Row="0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="65*"/>
                            <ColumnDefinition Width="35*"/>
                        </Grid.ColumnDefinitions>
                        <GroupBox Grid.Column="0" Header="Information" Foreground="White" BorderThickness="0.5" BorderBrush="#404040" Margin="4,4,4,4">
                            <Grid >

                                <DataGrid  Background="Transparent"  x:Name="FactoryGrid" 
                                ItemsSource="{Binding FactoryData}" SelectedItem="{Binding SelectedFactory, Mode=TwoWay}" 
                                    AutoGenerateColumns="False"
                                     SelectionMode="Single" 
                                     SelectionUnit="FullRow" 
                                     IsReadOnly="True" 
                                     VerticalContentAlignment="Bottom"
                                     VerticalScrollBarVisibility="Auto"                          
                                     CanUserAddRows="False"
                                     ScrollViewer.HorizontalScrollBarVisibility="Auto"
                                     ScrollViewer.VerticalScrollBarVisibility="Auto"
                                     GridLinesVisibility="None"
                                     HeadersVisibility="Column"
                                     RowBackground="#1e1e2f"
                                     BorderThickness="0"
                                     AlternatingRowBackground="#21213a"
                                    FontSize="15">

                                    <DataGrid.Resources>
                                        <!-- Style cho DataGridCell  -->
                                        <Style TargetType="DataGridCell">
                                            <Setter Property="Background" Value="Transparent"/>
                                            <Setter Property="Foreground" Value="White"/>
                                            <Setter Property="BorderThickness" Value="0"/>
                                            <Setter Property="FontSize" Value="12"/>
                                            <Setter Property="Padding" Value="5"/>
                                           
                                            <!-- Template để căn giữa hoàn hảo -->
                                            <Setter Property="Template">
                                                <Setter.Value>
                                                    <ControlTemplate TargetType="DataGridCell">
                                                        <Border Background="{TemplateBinding Background}" 
                                                BorderBrush="{TemplateBinding BorderBrush}" 
                                                BorderThickness="{TemplateBinding BorderThickness}"
                                                Padding="{TemplateBinding Padding}">    
                                                            <ContentPresenter HorizontalAlignment="Center" 
                                            VerticalAlignment="Center"/>
                                                        </Border>
                                                    </ControlTemplate>
                                                </Setter.Value>
                                            </Setter>

                                            <!-- Triggers cho Cell -->
                                            <Style.Triggers>
                                                <!-- Khi row được selected -->
                                                <DataTrigger Binding="{Binding IsSelected, RelativeSource={RelativeSource AncestorType=DataGridRow}}" Value="True">
                                                    <Setter Property="Background" Value="#404040"/>
                                                    <Setter Property="Foreground" Value="White"/>
                                                </DataTrigger>
                                                <!-- Khi hover -->
                                                <DataTrigger Binding="{Binding IsMouseOver, RelativeSource={RelativeSource AncestorType=DataGridRow}}" Value="True">
                                                    <Setter Property="Background" Value="#404040"/>
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>


                                    </DataGrid.Resources>

                                    <!-- Style cho header -->
                                    <DataGrid.ColumnHeaderStyle>
                                        <Style TargetType="DataGridColumnHeader">
                                            <Setter Property="Background" Value="#25253a"/>
                                            <Setter Property="Foreground" Value="#949ba8"/>
                                            <Setter Property="FontWeight" Value="SemiBold"/>
                                            <Setter Property="FontSize" Value="15"/>
                                            <Setter Property="HorizontalContentAlignment" Value="Center"/>
                                            <Setter Property="VerticalContentAlignment" Value="Center"/>
                                            <Setter Property="Padding" Value="8,8"/>
                                            <Setter Property="Height" Value="40"/>
                                            <Setter Property="BorderThickness" Value="1,1,1,1"/>
                                            <Setter Property="BorderBrush" Value="Transparent"/>
                                        </Style>
                                    </DataGrid.ColumnHeaderStyle>

                                    <DataGrid.Columns >
                                        <DataGridTextColumn Header="No" Binding="{Binding No}" Width="Auto">
                                            <DataGridTextColumn.ElementStyle>
                                                <Style TargetType="TextBlock">
                                                    <Setter Property="TextWrapping" Value="Wrap"/>
                                                    <Setter Property="VerticalAlignment" Value="Center"/>
                                                </Style>
                                            </DataGridTextColumn.ElementStyle>
                                        </DataGridTextColumn>
                                        <DataGridTemplateColumn Header="Factory Name"  Width="*">
                                            <DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate>
                                                    <TextBlock Text="{Binding FactoryName}" TextWrapping="Wrap"/>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellTemplate>
                                        </DataGridTemplateColumn>

                                        <DataGridTemplateColumn Header="Description" Width="*">
                                            <DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate>
                                                    <TextBlock Text="{Binding Description}" TextWrapping="Wrap"/>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellTemplate>
                                        </DataGridTemplateColumn>

                                        <DataGridTemplateColumn Header="Event User" Width="*">
                                            <DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate>
                                                    <TextBlock Text="{Binding Fullname}" TextWrapping="Wrap"/>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellTemplate>
                                        </DataGridTemplateColumn>
                                        <!--<DataGridTemplateColumn Header="Event time" Width="*">
                                            <DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate>
                                                    <TextBlock Text="{Binding EventTime}" TextWrapping="Wrap"/>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellTemplate>
                                        </DataGridTemplateColumn>-->
                                        <!--<DataGridTextColumn Header="Event time" Binding="{Binding EventTime, StringFormat='yyyy/MM/dd '}" Width="*" />-->

                                    </DataGrid.Columns>
                                </DataGrid>

                            </Grid>
                        </GroupBox>

                        <GroupBox Grid.Column="1"  Header="Editor" Foreground="White" BorderThickness="0.5" BorderBrush="#404040" Margin="4,4,4,4">
                            <Grid >
                                <DataGrid  x:Name="FactoryDataGrid" 
                                   ItemsSource="{Binding SelectedFactoryDetails}" 
                                   AutoGenerateColumns="False"
                                   CanUserAddRows="False" 
                                       FontWeight="DemiBold"
                                   SelectionUnit="FullRow"
                                   VerticalScrollBarVisibility="Auto"
                                   FontSize="15"  
                                   Background="Transparent"
                                 ScrollViewer.HorizontalScrollBarVisibility="Auto"
                                 ScrollViewer.VerticalScrollBarVisibility="Auto"
                                 GridLinesVisibility="None"
                                 HeadersVisibility="Column"
                                 RowBackground="#1e1e2f"
                                 BorderThickness="0"
                                 AlternatingRowBackground="#21213a" 
                                           >

                                    <DataGrid.Resources>
                                        <!-- Style cho DataGridCell  -->
                                        <Style TargetType="DataGridCell">
                                            <Setter Property="Background" Value="Transparent"/>
                                            <Setter Property="Foreground" Value="White"/>
                                            <Setter Property="BorderThickness" Value="0"/>
                                            <Setter Property="FontSize" Value="12"/>
                                            <Setter Property="Padding" Value="5"/>

                                            <!-- Template để căn giữa hoàn hảo -->
                                            <Setter Property="Template">
                                                <Setter.Value>
                                                    <ControlTemplate TargetType="DataGridCell">
                                                        <Border Background="{TemplateBinding Background}" 
                                                              BorderBrush="{TemplateBinding BorderBrush}" 
                                                              BorderThickness="{TemplateBinding BorderThickness}"
                                                              Padding="{TemplateBinding Padding}">
                                                               <ContentPresenter HorizontalAlignment="Center" 
                                                          VerticalAlignment="Center"/>
                                                        </Border>
                                                    </ControlTemplate>
                                                </Setter.Value>
                                            </Setter>

                                            <!-- Triggers cho Cell -->
                                            <Style.Triggers>
                                                <!-- Khi row được selected -->
                                                <DataTrigger Binding="{Binding IsSelected, RelativeSource={RelativeSource AncestorType=DataGridRow}}" Value="True">
                                                    <Setter Property="Background" Value="#404040"/>
                                                    <Setter Property="Foreground" Value="White"/>
                                                </DataTrigger>
                                                <!-- Khi hover -->
                                                <DataTrigger Binding="{Binding IsMouseOver, RelativeSource={RelativeSource AncestorType=DataGridRow}}" Value="True">
                                                    <Setter Property="Background" Value="#404040"/>
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>


                                    </DataGrid.Resources>

                                    <!-- Style cho header -->
                                    <DataGrid.ColumnHeaderStyle>
                                        <Style TargetType="DataGridColumnHeader">
                                            <Setter Property="Background" Value="#25253a"/>
                                            <Setter Property="Foreground" Value="#949ba8"/>
                                            <Setter Property="FontWeight" Value="SemiBold"/>
                                            <Setter Property="FontSize" Value="15"/>
                                            <Setter Property="HorizontalContentAlignment" Value="Center"/>
                                            <Setter Property="VerticalContentAlignment" Value="Center"/>
                                            <Setter Property="Padding" Value="8,8"/>
                                            <Setter Property="Height" Value="40"/>
                                            <Setter Property="BorderThickness" Value="1,1,1,1"/>
                                            <Setter Property="BorderBrush" Value="Transparent"/>
                                        </Style>
                                    </DataGrid.ColumnHeaderStyle>


                                    <DataGrid.Columns>
                                        <!-- Cột User Management Edit -->
                                        <DataGridTextColumn Header="Factory Edit" Binding="{Binding FactoryEdit}"  IsReadOnly="True" Width="70*">
                                            <DataGridTextColumn.ElementStyle>
                                                <Style TargetType="TextBlock">
                                                    <Setter Property="TextWrapping" Value="Wrap"/>
                                                    <Setter Property="VerticalAlignment" Value="Center"/>
                                                </Style>
                                            </DataGridTextColumn.ElementStyle>
                                        </DataGridTextColumn>

                                        <!-- Cột Value -->
                                        <DataGridTemplateColumn Header="Value" Width="130*">
                                            <DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate>
                                                    <TextBlock Text="{Binding Value}"
                                                       TextWrapping="Wrap"
                                                        VerticalAlignment="Center"/>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellTemplate>

                                            <DataGridTemplateColumn.CellEditingTemplate>
                                                <DataTemplate>
                                                    <ContentControl Content="{Binding}">
                                                        <ContentControl.Style>
                                                            <Style TargetType="ContentControl">
                                                                <Setter Property="ContentTemplate">
                                                                    <Setter.Value>
                                                                        <DataTemplate>
                                                                            <TextBox Text="{Binding Value, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                                             TextWrapping="Wrap"
                                                                               VerticalAlignment="Center"/>
                                                                        </DataTemplate>
                                                                    </Setter.Value>
                                                                </Setter>

                                                            </Style>
                                                        </ContentControl.Style>
                                                    </ContentControl>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellEditingTemplate>
                                        </DataGridTemplateColumn>
                                    </DataGrid.Columns>

                                </DataGrid>
                            </Grid>
                        </GroupBox>
                    </Grid>
                    <StackPanel Grid.Row="1" 
                          Orientation="Horizontal" 
                          HorizontalAlignment="Right"
                          Margin="0,0,15,0">
                        <Button Command="{Binding AddFactoryCommand}" 
                          Content="Create" 
                          Style="{StaticResource CreateButtonStyle}"
                          Margin="0,0,8,0"/>
                        <Button Command="{Binding EditactoryCommand}" 
                          Content="Update" 
                          Style="{StaticResource UpdateButtonStyle}"
                          Margin="0,0,8,0"/>
                        <Button Command="{Binding DeleteFactoryCommand}" 
                          Content="Delete" 
                          Style="{StaticResource DeleteButtonStyle}"/>
                    </StackPanel>

                </Grid>
            </TabItem>
            <TabItem Header="Machine Info" FontSize="16" Foreground="#FF2E417E" FontWeight="Bold" >
                <Grid  Margin="1,1,1,1" Background="#1F1C2C">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="65*"/>
                        <RowDefinition Height="35"/>
                    </Grid.RowDefinitions>
                    <Grid Grid.Row="0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="65*"/>
                            <ColumnDefinition Width="35*"/>
                        </Grid.ColumnDefinitions>
                        <GroupBox  Grid.Column="0" Header="Information" Foreground="White" BorderThickness="0.5" BorderBrush="#404040" Margin="4,4,4,4">
                            <Grid>
                                <DataGrid  x:Name="DeviceTypeDataGrid" 
                                      ItemsSource="{Binding DeviceTypeData}" 
                                      SelectedItem="{Binding SelectedDeviceTypeInfo, Mode=TwoWay}" 
                                      CanUserAddRows="False" 
                                      SelectionUnit="FullRow" 
                                      IsReadOnly="True"
                                      FontWeight="DemiBold"
                                      VerticalScrollBarVisibility="Auto"                             
                                      HeadersVisibility="Column"
                                      Background="Transparent"
                                     AutoGenerateColumns="False"
                                     SelectionMode="Single" 
                                     VerticalContentAlignment="Bottom"
                                     ScrollViewer.HorizontalScrollBarVisibility="Auto"
                                     ScrollViewer.VerticalScrollBarVisibility="Auto"
                                     GridLinesVisibility="None"
                                     RowBackground="#1e1e2f"
                                     BorderThickness="0"
                                     AlternatingRowBackground="#21213a"
                                      FontSize="15">

                                    <DataGrid.Resources>
                                        <!-- Style cho DataGridCell  -->
                                        <Style TargetType="DataGridCell">
                                            <Setter Property="Background" Value="Transparent"/>
                                            <Setter Property="Foreground" Value="White"/>
                                            <Setter Property="BorderThickness" Value="0"/>
                                            <Setter Property="FontSize" Value="12"/>
                                            <Setter Property="Padding" Value="5"/>

                                            <!-- Template để căn giữa hoàn hảo -->
                                            <Setter Property="Template">
                                                <Setter.Value>
                                                    <ControlTemplate TargetType="DataGridCell">
                                                        <Border Background="{TemplateBinding Background}" 
                                                              BorderBrush="{TemplateBinding BorderBrush}" 
                                                              BorderThickness="{TemplateBinding BorderThickness}"
                                                              Padding="{TemplateBinding Padding}">
                                                    <ContentPresenter HorizontalAlignment="Center" 
                                                          VerticalAlignment="Center"/>
                                                        </Border>
                                                    </ControlTemplate>
                                                </Setter.Value>
                                            </Setter>

                                            <!-- Triggers cho Cell -->
                                            <Style.Triggers>
                                                <!-- Khi row được selected -->
                                                <DataTrigger Binding="{Binding IsSelected, RelativeSource={RelativeSource AncestorType=DataGridRow}}" Value="True">
                                                    <Setter Property="Background" Value="#404040"/>
                                                    <Setter Property="Foreground" Value="White"/>
                                                </DataTrigger>
                                                <!-- Khi hover -->
                                                <DataTrigger Binding="{Binding IsMouseOver, RelativeSource={RelativeSource AncestorType=DataGridRow}}" Value="True">
                                                    <Setter Property="Background" Value="#404040"/>
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>


                                    </DataGrid.Resources>

                                    <!-- Style cho header -->
                                    <DataGrid.ColumnHeaderStyle>
                                        <Style TargetType="DataGridColumnHeader">
                                            <Setter Property="Background" Value="#25253a"/>
                                            <Setter Property="Foreground" Value="#949ba8"/>
                                            <Setter Property="FontWeight" Value="SemiBold"/>
                                            <Setter Property="FontSize" Value="15"/>
                                            <Setter Property="HorizontalContentAlignment" Value="Center"/>
                                            <Setter Property="VerticalContentAlignment" Value="Center"/>
                                            <Setter Property="Padding" Value="8,8"/>
                                            <Setter Property="Height" Value="40"/>
                                            <Setter Property="BorderThickness" Value="1,1,1,1"/>
                                            <Setter Property="BorderBrush" Value="Transparent"/>
                                        </Style>
                                    </DataGrid.ColumnHeaderStyle>

                                    <DataGrid.Columns>
                                        <DataGridTextColumn Header="No" Binding="{Binding NO}" Width="auto">
                                            <DataGridTextColumn.ElementStyle>
                                                <Style TargetType="TextBlock">
                                                    <Setter Property="TextWrapping" Value="Wrap" />
                                                    <Setter Property="VerticalAlignment" Value="Center"/>
                                                </Style>
                                            </DataGridTextColumn.ElementStyle>
                                        </DataGridTextColumn>
                                        <DataGridTextColumn Header="Machine Type" Binding="{Binding Device_type}" Width="*">
                                            <DataGridTextColumn.ElementStyle>
                                                <Style TargetType="TextBlock">
                                                    <Setter Property="TextWrapping" Value="Wrap" />
                                                    <Setter Property="VerticalAlignment" Value="Center"/>
                                                </Style>
                                            </DataGridTextColumn.ElementStyle>
                                        </DataGridTextColumn>
                                        <DataGridTextColumn Header="Machine Name" Binding="{Binding Device_Name}" Width="*" >
                                            <DataGridTextColumn.ElementStyle>
                                                <Style TargetType="TextBlock">
                                                    <Setter Property="TextWrapping" Value="Wrap" />
                                                    <Setter Property="VerticalAlignment" Value="Center"/>
                                                </Style>
                                            </DataGridTextColumn.ElementStyle>
                                        </DataGridTextColumn>
                                        <!--<DataGridTextColumn Header="Description" Binding="{Binding Description}" Width="150" >
                                            <DataGridTextColumn.ElementStyle>
                                                <Style TargetType="TextBlock">
                                                    <Setter Property="TextWrapping" Value="Wrap" />
                                                    <Setter Property="VerticalAlignment" Value="Center"/>
                                                </Style>
                                            </DataGridTextColumn.ElementStyle>
                                        </DataGridTextColumn>-->
                                        <DataGridTextColumn Header="Factory" Binding="{Binding Factory}" Width="*" >
                                            <DataGridTextColumn.ElementStyle>
                                                <Style TargetType="TextBlock">
                                                    <Setter Property="TextWrapping" Value="Wrap" />
                                                    <Setter Property="VerticalAlignment" Value="Center"/>
                                                </Style>
                                            </DataGridTextColumn.ElementStyle>
                                        </DataGridTextColumn>

                                        <DataGridTextColumn Header="Even User" Binding="{Binding Event_User}" Width="*" >
                                            <DataGridTextColumn.ElementStyle>
                                                <Style TargetType="TextBlock">
                                                    <Setter Property="TextWrapping" Value="Wrap" />
                                                    <Setter Property="VerticalAlignment" Value="Center"/>
                                                </Style>
                                            </DataGridTextColumn.ElementStyle>
                                        </DataGridTextColumn>

                                        <!--<DataGridTextColumn Header="Even Time" Binding="{Binding Event_Time}" Width="*" >
                                            <DataGridTextColumn.ElementStyle>
                                                <Style TargetType="TextBlock">
                                                    <Setter Property="TextWrapping" Value="Wrap" />
                                                    <Setter Property="VerticalAlignment" Value="Center"/>
                                                </Style>
                                            </DataGridTextColumn.ElementStyle>
                                        </DataGridTextColumn>-->

                                    </DataGrid.Columns>
                                </DataGrid>
                            </Grid>
                        </GroupBox>

                        <GroupBox Grid.Column="1"  Header="Editor" Foreground="White" BorderThickness="0.5" BorderBrush="#404040" Margin="4,4,4,4">
                            <Grid >
                                <DataGrid  x:Name="DeviceTypeEdit" 
                                      ItemsSource="{Binding DeviceTypeEditItem}" 
                                      AutoGenerateColumns="False" 
                        
                                                   FontWeight="DemiBold"
                                      FontSize="15" 
                                      Grid.ColumnSpan="2" 
                                         SelectionMode="Single" 
                                         SelectionUnit="FullRow" 
                                         IsReadOnly="True" 
                                         VerticalContentAlignment="Bottom"
                                         VerticalScrollBarVisibility="Auto"
                                         Background="Transparent"
                                         CanUserAddRows="False"
                                         ScrollViewer.HorizontalScrollBarVisibility="Auto"
                                         ScrollViewer.VerticalScrollBarVisibility="Auto"
                                         GridLinesVisibility="None"
                                         HeadersVisibility="Column"
                                         RowBackground="#1e1e2f"
                                         BorderThickness="0"
                                         AlternatingRowBackground="#21213a"
                                           >

                                    <DataGrid.Resources>
                                        <!-- Style cho DataGridCell  -->
                                        <Style TargetType="DataGridCell">
                                            <Setter Property="Background" Value="Transparent"/>
                                            <Setter Property="Foreground" Value="White"/>
                                            <Setter Property="BorderThickness" Value="0"/>
                                            <Setter Property="FontSize" Value="12"/>
                                            <Setter Property="Padding" Value="5"/>

                                            <!-- Template để căn giữa hoàn hảo -->
                                            <Setter Property="Template">
                                                <Setter.Value>
                                                    <ControlTemplate TargetType="DataGridCell">
                                                        <Border Background="{TemplateBinding Background}" 
                                                              BorderBrush="{TemplateBinding BorderBrush}" 
                                                              BorderThickness="{TemplateBinding BorderThickness}"
                                                              Padding="{TemplateBinding Padding}">
                                                         <ContentPresenter HorizontalAlignment="Center" 
                                                          VerticalAlignment="Center"/>
                                                        </Border>
                                                    </ControlTemplate>
                                                </Setter.Value>
                                            </Setter>

                                            <!-- Triggers cho Cell -->
                                            <Style.Triggers>
                                                <!-- Khi row được selected -->
                                                <DataTrigger Binding="{Binding IsSelected, RelativeSource={RelativeSource AncestorType=DataGridRow}}" Value="True">
                                                    <Setter Property="Background" Value="#404040"/>
                                                    <Setter Property="Foreground" Value="White"/>
                                                </DataTrigger>
                                                <!-- Khi hover -->
                                                <DataTrigger Binding="{Binding IsMouseOver, RelativeSource={RelativeSource AncestorType=DataGridRow}}" Value="True">
                                                    <Setter Property="Background" Value="#404040"/>
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>


                                    </DataGrid.Resources>

                                    <!-- Style cho header -->
                                    <DataGrid.ColumnHeaderStyle>
                                        <Style TargetType="DataGridColumnHeader">
                                            <Setter Property="Background" Value="#25253a"/>
                                            <Setter Property="Foreground" Value="#949ba8"/>
                                            <Setter Property="FontWeight" Value="SemiBold"/>
                                            <Setter Property="FontSize" Value="15"/>
                                            <Setter Property="HorizontalContentAlignment" Value="Center"/>
                                            <Setter Property="VerticalContentAlignment" Value="Center"/>
                                            <Setter Property="Padding" Value="8,8"/>
                                            <Setter Property="Height" Value="40"/>
                                            <Setter Property="BorderThickness" Value="1,1,1,1"/>
                                            <Setter Property="BorderBrush" Value="Transparent"/>
                                        </Style>
                                    </DataGrid.ColumnHeaderStyle>

                                    <DataGrid.Columns>
                                        <!--Cột Device type Edit-->
                                        <DataGridTextColumn Header="Machine Type Edit" Binding="{Binding DeviceTypeName}" IsReadOnly="True" Width="70*">
                                            <DataGridTextColumn.ElementStyle>
                                                <Style TargetType="TextBlock">
                                                    <Setter Property="TextWrapping" Value="Wrap"/>
                                                    <Setter Property="VerticalAlignment" Value="Center"/>
                                                </Style>
                                            </DataGridTextColumn.ElementStyle>
                                        </DataGridTextColumn>

                                        <!--Cột Value-->
                                        <DataGridTemplateColumn Header="Value" Width="120*">
                                            <DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate>
                                                    <TextBlock Text="{Binding Value}" 
                                                   TextWrapping="Wrap"
                                                   VerticalAlignment="Center"/>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellTemplate>

                                            <DataGridTemplateColumn.CellEditingTemplate>
                                                <DataTemplate>
                                                    <ContentControl Content="{Binding}">
                                                        <ContentControl.Style>
                                                            <Style TargetType="ContentControl">
                                                                <Setter Property="ContentTemplate">
                                                                    <Setter.Value>
                                                                        <DataTemplate>
                                                                            <TextBox Text="{Binding Value, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                                                                        </DataTemplate>
                                                                    </Setter.Value>
                                                                </Setter>
                                                                <Style.Triggers>
                                                                    <!-- Nếu UserEdit là "Factory" thì cũng hiển thị ComboBox -->
                                                                    <DataTrigger Binding="{Binding DeviceTypeName}" Value="Factory">
                                                                        <Setter Property="ContentTemplate">
                                                                            <Setter.Value>
                                                                                <DataTemplate>
                                                                                    <ComboBox ItemsSource="{Binding DataContext.Factoryitem, RelativeSource={RelativeSource AncestorType=UserControl}}"
                                                               SelectedItem="{Binding Value, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                                                                                </DataTemplate>
                                                                            </Setter.Value>
                                                                        </Setter>
                                                                    </DataTrigger>
                                                                </Style.Triggers>
                                                            </Style>
                                                        </ContentControl.Style>
                                                    </ContentControl>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellEditingTemplate>
                                        </DataGridTemplateColumn>
                                    </DataGrid.Columns>
                                </DataGrid>
                            </Grid>
                        </GroupBox>

                    </Grid>
                    <StackPanel Grid.Row="1" 
                          Orientation="Horizontal" 
                          HorizontalAlignment="Right"
                          Margin="0,0,15,0">
                                            <Button Command="{Binding CreateDeviceTypeCommand}" 
                          Content="Create" 
                          Style="{StaticResource CreateButtonStyle}"
                          Margin="0,0,8,0"/>
                                            <Button Command="{Binding UpdateDeviceTypeCommand}" 
                          Content="Update" 
                          Style="{StaticResource UpdateButtonStyle}"
                          Margin="0,0,8,0"/>
                                            <Button Command="{Binding DeleteDeviceTypeCommand}" 
                          Content="Delete" 
                          Style="{StaticResource DeleteButtonStyle}"/>
                    </StackPanel>
                    
                </Grid>
            </TabItem>


        </TabControl>

    </Grid>
</UserControl>
